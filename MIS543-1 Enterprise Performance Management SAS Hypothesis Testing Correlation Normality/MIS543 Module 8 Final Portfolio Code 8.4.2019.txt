*MIS543 Module 8 Final Portfolio Project Code - Lawrence Wilson;
Data Northwind;
Infile '/folders/myfolders/orders_northwind_mod8.csv' DLM=',' DSD FIRSTOBS=2;
Input order_id $ customer_id $ employee_id $ territory_id $ product_id $ category_id $ unit_price quantity discount gross_sale discount_amt net_sale;
If employee_id = 1 Then emp_1 = 1; Else emp_1 = 0; If employee_id = 2 Then emp_2 = 1; Else emp_2 = 0; If employee_id = 3 Then emp_3 = 1; Else emp_3 = 0; If employee_id = 4 Then emp_4 = 1; Else emp_4 = 0; If employee_id = 5 Then emp_5 = 1; Else emp_5 = 0; If employee_id = 6 Then emp_6 = 1; Else emp_6 = 0; If employee_id = 8 Then emp_8 = 1; Else emp_8 = 0; If employee_id = 9 Then emp_9 = 1; Else emp_9 = 0;
If customer_id = 'BLONP' Then BLONP = 1; Else BLONP = 0; If customer_id = 'CENTC' Then CENTC = 1; Else CENTC = 0; If customer_id = 'CHOPS' Then CHOPS = 1; Else CHOPS = 0; If customer_id = 'ERNSH' Then ERNSH = 1; Else ERNSH = 0; If customer_id = 'FOLKO' Then FOLKO = 1; Else FOLKO = 0; If customer_id = 'FRANK' Then FRANK = 1; Else FRANK = 0; If customer_id = 'GROSR' Then GROSR = 1; Else GROSR = 0; If customer_id = 'HANAR' Then HANAR = 1; Else HANAR = 0; If customer_id = 'HILAA' Then HILAA = 1; Else HILAA = 0; If customer_id = 'OTTIK' Then OTTIK = 1; Else OTTIK = 0;
If customer_id = 'QUEDE' Then QUEDE = 1; Else QUEDE = 0; If customer_id = 'RATTC' Then RATTC = 1; Else RATTC = 0; If customer_id = 'RICSU' Then RICSU = 1; Else RICSU = 0; If customer_id = 'SUPRD' Then SUPRD = 1; Else SUPRD = 0; If customer_id = 'TOMSP' Then TOMSP = 1; Else TOMSP = 0; If customer_id = 'VICTE' Then VICTE = 1; Else VICTE = 0; If customer_id = 'VINET' Then VINET = 1; Else VINET = 0; If customer_id = 'WARTH' Then WARTH = 1; Else WARTH = 0; If customer_id = 'WELLI' Then WELLI = 1; Else WELLI = 0;
If category_id = 1 Then cat_1 = 1; Else cat_1 = 0; If category_id = 2 Then cat_2 = 1; Else cat_2 = 0;If category_id = 3 Then cat_3 = 1; Else cat_3 = 0; If category_id = 4 Then cat_4 = 1; Else cat_4 = 0; If category_id = 5 Then cat_5 = 1; Else cat_5 = 0; If category_id = 6 Then cat_6 = 1; Else cat_6 = 0; If category_id = 7 Then cat_7 = 1; Else cat_7 = 0; If category_id = 8 Then cat_8 = 1; Else cat_8 = 0;
If gross_sale > 493 Then high_trans = 1; Else high_trans = 0;  
If territory_id = 1581 Then T1581 = 1; Else T1581 = 0;If territory_id = 1730 Then T1730 = 1; Else T1730 = 0;If territory_id = 1833 Then T1833 = 1; Else T1833 = 0;If territory_id = 2116 Then T2116 = 1; Else T2116 = 0;If territory_id = 2139 Then T2139 = 1; Else T2139 = 0;If territory_id = 2184 Then T2184 = 1; Else T2184 = 0;If territory_id = 2903 Then T2903 = 1; Else T2903 = 0;If territory_id = 3049 Then T3049 = 1; Else T3049 = 0;If territory_id = 3801 Then T3801 = 1; Else T3801 = 0;If territory_id = 6897 Then T6897 = 1; Else T6897 = 0;If territory_id = 7960 Then T7960 = 1; Else T7960 = 0;If territory_id = 8837 Then T8837 = 1; Else T8837 = 0;If territory_id = 10019 Then T10019 = 1; Else T10019 = 0;
If territory_id = 10038 Then T10038 = 1; Else T10038 = 0;If territory_id = 11747 Then T11747 = 1; Else T11747 = 0;If territory_id = 14450 Then T14450 = 1; Else T14450 = 0;If territory_id = 19428 Then T19428 = 1; Else T19428 = 0;If territory_id = 19713 Then T19713 = 1; Else T19713 = 0;If territory_id = 20852 Then T20852 = 1; Else T20852 = 0;If territory_id = 27403 Then T27403 = 1; Else T27403 = 0;If territory_id = 27511 Then T27511 = 1; Else T27511 = 0;If territory_id = 30346 Then T30346 = 1; Else T30346 = 0;If territory_id = 31406 Then T31406 = 1; Else T31406 = 0;If territory_id = 32859 Then T32859 = 1; Else T32859 = 0;If territory_id = 33607 Then T33607 = 1; Else T33607 = 0;If territory_id = 40222 Then T40222 = 1; Else T40222 = 0;If territory_id = 44122 Then T44122 = 1; Else T44122 = 0;If territory_id = 45839 Then T45839 = 1; Else T45839 = 0;
If territory_id = 48075 Then T48075 = 1; Else T48075 = 0;If territory_id = 48084 Then T48084 = 1; Else T48084 = 0;If territory_id = 48304 Then T48304 = 1; Else T48304 = 0;If territory_id = 53404 Then T53404 = 1; Else T53404 = 0;If territory_id = 55113 Then T55113 = 1; Else T55113 = 0;If territory_id = 55439 Then T55439 = 1; Else T55439 = 0;If territory_id = 85014 Then T85014 = 1; Else T85014 = 0;If territory_id = 85251 Then T85251 = 1; Else T85251 = 0;If territory_id = 98004 Then T98004 = 1; Else T98004 = 0;If territory_id = 98052 Then T98052 = 1; Else T98052 = 0;If territory_id = 98104 Then T98104 = 1; Else T98104 = 0;
Proc Print Data = Northwind (Obs = 50);
Run;
Proc Means Data = Northwind N Nmiss Mean Median Mode Stddev Min Max Sum; Var unit_price quantity discount gross_sale discount_amt net_sale;
Title 'Northwind Total Population Descriptive Statistics';
Run;
Proc Sgplot Data = Northwind;
Hbar category_id/Response=gross_sale Stat=Sum; 
Title 'Product Category Total Gross Sales Horizontal Bar Chart';
Run;
Proc Sgplot Data = Northwind;
Hbar category_id/Response=quantity Stat=Sum; 
Title 'Product Category Total Quantity Sold Horizontal Bar Chart';
Run;
Proc Means Data = Northwind N Nmiss Mean Median Mode Stddev Min Max Sum; Class category_id; Var unit_price quantity discount gross_sale discount_amt net_sale;
Title 'Northwind Product Category Descriptive Statistics';
Run;
Proc Sgplot Data = Northwind;
Hbar customer_id/Response=gross_sale Stat=Sum; 
Title 'Customer Total Gross Sales Horizontal Bar Chart';
Run;
Proc Sgplot Data = Northwind;
Hbar customer_id/Response=quantity Stat=Sum; 
Title 'Customer Total Quantity Sold Horizontal Bar Chart';
Run;
Proc Means Data = Northwind N Nmiss Mean Median Mode Stddev Min Max Sum; Class customer_id; Var unit_price quantity discount gross_sale discount_amt net_sale;
Title 'Northwind Customer Descriptive Statistics';
Run;
Proc Sgplot Data = Northwind;
Hbar employee_id/Response=gross_sale Stat=Sum; 
Title 'Employee Total Gross Sales Horizontal Bar Chart';
Run;
Proc Sgplot Data = Northwind;
Hbar employee_id/Response=quantity Stat=Sum; 
Title 'Employee Total Quantity Sold Horizontal Bar Chart';
Run;
Proc Means Data = Northwind N Nmiss Mean Median Mode Stddev Min Max Sum; Class employee_id; Var unit_price quantity discount gross_sale discount_amt net_sale;
Title 'Northwind Employee Descriptive Statistics';
Run;
Proc Sgplot Data = Northwind;
Hbar territory_id/Response=gross_sale Stat=Sum; 
Title 'Territory Total Gross Sales Horizontal Bar Chart';
Run;
Proc Sgplot Data = Northwind;
Hbar territory_id/Response=quantity Stat=Sum; 
Title 'Territory Total Quantity Sold Horizontal Bar Chart';
Run;
Proc Means Data = Northwind N Nmiss Mean Median Mode Stddev Min Max Sum; Class territory_id; Var unit_price quantity discount gross_sale discount_amt net_sale;
Title 'Territory Descriptive Statistics';
Run;
Proc Logistic Data = Northwind Descending;
Model high_trans = emp_1 emp_2 emp_3 emp_4 emp_5 emp_6 emp_8 emp_9/EXPB selection = stepwise slstay = .05;
Title 'Employee High Transaction Binary Logistic Regression Analysis';
Run;
Proc Logistic Data = Northwind Descending;
Model high_trans = BLONP CENTC CHOPS ERNSH FOLKO FRANK GROSR HANAR HILAA OTTIK QUEDE RATTC RICSU SUPRD TOMSP VICTE VINET WARTH WELLI/EXPB selection = stepwise slstay = .05;
Title 'Customer High Transaction Binary Logistic Regression Analysis';
Run;
Proc Logistic Data = Northwind Descending;
Model high_trans = cat_1 cat_2 cat_3 cat_4 cat_5 cat_6 cat_7/EXPB selection = stepwise slstay = .05;
Title 'Product Category High Transaction Binary Logistic Regression Analysis';
Run;
Proc Logistic Data = Northwind Descending;
Model high_trans = T1581 T1730 T1833 T2116 T2139 T2184 T2903 T3049 T3801 T6897 T7960 T8837 T10019 T10038 T11747 T14450 T19428 T19713
T20852 T27403 T27511 T30346 T31406 T32859 T33607 T40222 T44122 T45839 T48075 T48084 T48304 T53404 T55113 T55439 T85014 T85251 T98004 T98052 T98104
/EXPB selection = stepwise slstay = .05;
Title 'Territory High Transaction Binary Logistic Regression Analysis';
Run;
Proc Corr Data = Northwind Plots(Maxpoints=1000)=Scatter Pearson Spearman;
Var Quantity;
With unit_price discount;
Title 'Northwind Quantitative Variable Correlation Analysis';
Run;
Quit;
Title; Footnote;